# Python コードレビューガイドライン

このガイドラインは、Pythonコードのレビューに特化した観点を提供します。一般的なコードレビューの観点については[一般的なコードレビューガイド](./general_code_review_guide.md)を参照してください。

## レビュー観点

### コードレイアウト

#### インデント
- インデントは4スペースを使用していますか？
- タブとスペースが混在していませんか？

#### 行の長さ
- 1行の長さは79文字以内に収まっていますか？
- 長い行は適切に折り返されていますか？
- ドキュメント文字列やコメントは72文字以内に収まっていますか？

#### 空行
- トップレベルの関数とクラスの定義は2行の空行で区切られていますか？
- クラス内のメソッド定義は1行の空行で区切られていますか？
- 関連する機能のグループを区切るために空行が適切に使用されていますか？

#### インポート
- インポートは別々の行で記述されていますか？
- インポートは以下のグループに分けられ、それぞれ空行で区切られていますか？
  1. 標準ライブラリ
  2. 関連サードパーティライブラリ
  3. ローカルアプリケーション/ライブラリ固有のインポート
- インポートはアルファベット順にソートされていますか？
- ワイルドカードインポート (`from <module> import *`) は避けられていますか？

### 命名規則

#### 命名スタイル
- クラス名: `CapWords` (パスカルケース)
- 関数・変数・メソッド: `lowercase_with_underscores` (スネークケース)
- 定数: `UPPERCASE_WITH_UNDERSCORES`
- プロテクテッドメンバー: `_single_leading_underscore`
- プライベートメンバー: `__double_leading_underscore`
- マジックメソッド: `__double_leading_and_trailing_underscores__`

#### 命名の意味
- 変数や関数の名前は、その目的や内容を明確に表していますか？
- 一文字の変数名は、ループカウンタや一時的な変数以外では避けられていますか？

### 式と文

#### 空白
- 次の場合、余分なスペースを避けていますか？
  - 括弧の内側: `spam(ham[1], {eggs: 2})`
  - カンマ、セミコロン、コロンの前: `if x == 4: print(x, y); x, y = y, x`
  - 関数呼び出しの開き括弧の前: `spam(1)`
  - インデックスやスライスの開き括弧の前: `dict['key']`
- 次の場合、スペースを入れていますか？
  - 二項演算子の前後: `x == 1`
  - 代入 (`=`)、拡張代入 (`+=`, `-=` など) の前後
  - カンマの後: `a, b = 1, 2`

#### 複合文
- 複合文（複数の文を一行に書く）は避けていますか？
  - 良い例: 
    ```python
    if foo == 'blah':
        do_something()
    ```
  - 悪い例: 
    ```python
    if foo == 'blah': do_something()
    ```

### コメント

- ドキュメント文字列（docstrings）はモジュール、関数、クラス、メソッドに提供されていますか？
- コメントは最新かつ正確な情報を提供していますか？
- コメントは明らかなことを説明するのではなく、「なぜ」そのコードが必要かを説明していますか？
- ブロックコメントは完全な文で、各文は大文字で始まり句読点で終わっていますか？

### Pythonの特徴的な機能

#### リスト内包表記
- 複雑なリスト内包表記よりも、可読性の高いループ構造が使用されていますか？
- 複数行にまたがるリスト内包表記は適切に改行されていますか？

#### 例外処理
- 裸の `except:` 節は使用されていませんか？（特定の例外型を指定すべき）
- `try/except` ブロックの範囲は最小限に保たれていますか？

#### コンテキストマネージャ
- ファイル操作やリソース管理には `with` ステートメントが使用されていますか？

#### 型ヒント
- 関数の引数と戻り値に型ヒント（Type Hints）が適切に提供されていますか？
- 複雑な型には `typing` モジュールが適切に使用されていますか？

### パフォーマンスと最適化

- リストよりも効率的なジェネレータ式が適切な場所で使用されていますか？
- 大量のデータ処理時には適切なデータ構造（セット、辞書など）が選択されていますか？
- 無限ループの可能性はありませんか？

### テスト関連

- テストコードにはアサーションメッセージが含まれていますか？
- モックやパッチが適切に使用されていますか？
- テスト関数名は目的を明確に示していますか？

### その他のPython固有の観点

- f-strings、str.format()、%-形式のどれを使用するか一貫していますか？
- モジュール内の `if __name__ == "__main__":` の使用は適切ですか？
- プロパティデコレータ（`@property`）は適切に使用されていますか？
- 可変デフォルト引数（`def func(a=[])`）の誤用はありませんか？

## 参考資料

- [PEP 8 -- Style Guide for Python Code](https://www.python.org/dev/peps/pep-0008/)
- [Google Python Style Guide](https://google.github.io/styleguide/pyguide.html)
